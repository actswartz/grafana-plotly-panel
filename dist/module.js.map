{"version":3,"sources":["../src/module.js"],"names":["MetricsPanelCtrl","_","moment","angular","Plotly","PlotlyPanelCtrl","$scope","$injector","$q","$rootScope","$timeout","$window","timeSrv","uiSegmentSrv","detangleSrv","templateSrv","q","sortingOrder","couplingMetrics","targetSelections","sizeChanged","initalized","$tooltip","$","dcfg","mapping","x","y","z","color","size","settings","type","mode","displayModeBar","line","width","dash","shape","marker","symbol","colorscale","sizemode","sizemin","sizeref","showscale","color_option","layout","autosize","showlegend","legend","dragmode","hovermode","plot_bgcolor","paper_bgcolor","font","family","margin","t","b","l","r","xaxis","showgrid","zeroline","gridcolor","rangemode","yaxis","scene","title","zaxis","detangle","coupling","limit","metric","sourceType","targetType","sourceTypeData","targetTypeData","author","authorData","target","minIssuesPerFile","minIssuesData","minFilesPerIssue","minFilesData","issueTitle","issueTitleData","fileExcludeFilter","fileExcludeFilterData","fileGroup","fileGroupData","metricRange","metricRangeData","localSearch","cohesionCalculationMethod","isAuthorDashboard","panel","pconfig","extend","cfg","trace","events","on","onInitEditMode","bind","onRender","onDataReceived","onDataError","onPanelInitalized","onRefresh","text","value","cohesionCalculationMethods","element","onResize","err","seriesList","render","console","log","otherPanelInFullscreenMode","graph","redraw","addEditorTab","refresh","segs","newSegment","subTabIndex","axis","disp","idx","config","name","onConfigChanged","s","options","showLink","displaylogo","modeBarButtonsToRemove","data","rect","getBoundingClientRect","old","height","newPlot","Error","xxx","points","length","pt","dataText","undefined","ts","pointNumber","body","html","place_tt","mouse","pageX","pageY","detach","min","Number","MAX_SAFE_INTEGER","max","MIN_SAFE_INTEGER","i","Math","range","from","utc","to","setTime","Plots","purge","innerHTML","resize","dataList","dmapping","t0","performance","now","dataConvertor","t1","key","missing","datapoints","val","isString","isBoolean","j","push","columns","rows","dX","dY","dZ","dC","dS","dT","message","scope","elem","attrs","ctrl","find","evt","txt","forEach","when","templateUrl"],"mappings":"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","file":"module.js","sourcesContent":["\nimport {MetricsPanelCtrl} from  'app/plugins/sdk';\n\nimport _ from 'lodash';\nimport moment from 'moment';\nimport angular from 'angular';\n\nimport * as Plotly from './external/plotly';\n\nclass PlotlyPanelCtrl extends MetricsPanelCtrl {\n\n  constructor($scope, $injector, $q, $rootScope, $timeout, $window, timeSrv, uiSegmentSrv, detangleSrv, templateSrv) {\n    super($scope, $injector);\n    this.detangleSrv = detangleSrv;\n    this.templateSrv = templateSrv;\n    this.$rootScope = $rootScope;\n    this.timeSrv = timeSrv;\n    this.uiSegmentSrv = uiSegmentSrv;\n    this.q = $q;\n\n    this.sortingOrder = [];\n    this.couplingMetrics = [];\n    this.targetSelections = [];\n\n    this.sizeChanged = true;\n    this.initalized = false;\n\n    this.$tooltip = $('<div id=\"tooltip\" class=\"graph-tooltip\">');\n\n\n    var dcfg = {\n      mapping: {\n        x: null,\n        y: null,\n        z: null,\n        color: null,\n        size: null,\n      },\n      settings: {\n        type: 'scatter',\n        mode: 'lines+markers',\n        displayModeBar: false,\n        line: {\n          color : '#005f81',\n          width : 6,\n          dash  : 'solid',\n          shape : 'linear'\n        },\n        marker: {\n          size: 30,\n          symbol: 'circle',\n          color: '#33B5E5',\n          colorscale: 'YIOrRd',\n          sizemode: 'diameter',\n          sizemin: 3,\n          sizeref: 0.2,\n          line: {\n            color: '#DDD',\n            width: 0\n          },\n          showscale: true\n        },\n        color_option: 'ramp'\n      },\n      layout: {\n        autosize: false,\n        showlegend: false,\n        legend: {\"orientation\": \"v\"},\n        dragmode: 'lasso', // (enumerated: \"zoom\" | \"pan\" | \"select\" | \"lasso\" | \"orbit\" | \"turntable\" )\n        hovermode: 'closest',\n        plot_bgcolor: \"#1f1d1d\",\n        paper_bgcolor: 'rgba(0,0,0,0)', // transparent?\n        font: {\n          color: '#D8D9DA',\n          family: '\"Open Sans\", Helvetica, Arial, sans-serif'\n        },\n        margin: {\n          t: 0,\n          b: 45,\n          l: 65,\n          r: 20,\n        },\n        xaxis: {\n          showgrid: true,\n          zeroline: false,\n          type: 'linear',\n          gridcolor: '#444444',\n          rangemode: 'normal' // (enumerated: \"normal\" | \"tozero\" | \"nonnegative\" )\n        },\n        yaxis: {\n          showgrid: true,\n          zeroline: false,\n          type: 'linear',\n          gridcolor: '#444444',\n          rangemode: 'normal' // (enumerated: \"normal\" | \"tozero\" | \"nonnegative\" )\n        },\n        scene: {\n          xaxis:{title: 'X AXIS'},\n          yaxis:{title: 'Y AXIS'},\n          zaxis:{title: 'Z AXIS'},\n        },\n      },\n      detangle: {\n        coupling: false,\n        sortingOrder: 'desc',\n        limit: null,\n        metric: 'coupling',\n        sourceType: '$issue_type',\n        targetType: '$target_issue_type',\n        sourceTypeData: '',\n        targetTypeData: '',\n        author: '$author',\n        authorData: '',\n        target: 'issue',\n        minIssuesPerFile: null,\n        minIssuesData: '',\n        minFilesPerIssue: null,\n        minFilesData: '',\n        issueTitle: '$issue_title',\n        issueTitleData: '',\n        fileExcludeFilter: '$file_exclude',\n        fileExcludeFilterData: '',\n        fileGroup: '$file_group',\n        fileGroupData: '',\n        metricRange: '$metric_range',\n        metricRangeData: '',\n        localSearch: '',\n        cohesionCalculationMethod: 'standard',\n        isAuthorDashboard: false,\n      },\n    };\n\n    // Make sure it has the default settings (may have more!)\n    this.panel.pconfig = $.extend(true, dcfg, this.panel.pconfig );\n\n    var cfg = this.panel.pconfig;\n    this.trace = { };\n    this.layout = $.extend(true, {}, this.panel.pconfig.layout );\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('render', this.onRender.bind(this));\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    this.events.on('panel-initialized', this.onPanelInitalized.bind(this));\n    this.events.on('refresh', this.onRefresh.bind(this));\n\n    /**\n     * @detangleEdit start\n     * @author Ural\n     */\n    this.sortingOrder = [\n      {text: 'Ascending', value: 'asc'},\n      {text: 'Descending', value: 'desc'},\n    ];\n\n    this.couplingMetrics = [\n      {text: 'Coupling Value', value: 'coupling'},\n      {text: 'Num. of Couples', value: 'couplecounts'},\n    ];\n\n    this.targetSelections = [\n      {text: 'Issues|Committers', value: 'issue'},\n      {text: 'Files', value: 'file'},\n    ];\n\n    this.cohesionCalculationMethods = [\n      {\n        text: 'Standard', value: 'standard'\n      },\n      {\n        text: 'Double', value: 'double'\n      },\n    ];\n    /**\n     * @detangleEdit end\n     * @author Ural\n     */\n\n    angular.element($window).bind('resize', this.onResize.bind(this) );\n  }\n\n  onResize() {\n    this.sizeChanged = true;\n  }\n\n  onDataError(err) {\n    this.seriesList = [];\n    this.render([]);\n    console.log(\"onDataError\", err);\n  }\n\n  onRefresh() {\n    // ignore fetching data if another panel is in fullscreen\n    if (this.otherPanelInFullscreenMode()) { return; }\n\n\n    if(this.graph && this.initalized) {\n      Plotly.redraw(this.graph);\n    }\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Display', 'public/plugins/natel-plotly-panel/tab_display.html',2);\n    this.addEditorTab('Detangle', 'public/plugins/natel-plotly-panel/detangle.html',3);\n\n    //  this.editorTabIndex = 1;\n    this.refresh();\n    this.segs = {\n      symbol: this.uiSegmentSrv.newSegment({value: this.panel.pconfig.settings.marker.symbol })\n    };\n    this.subTabIndex = 0; // select the options\n\n    var cfg = this.panel.pconfig;\n    this.axis = [\n      { disp: 'X Axis', idx: 1, config: cfg.layout.xaxis, metric: (name) => { if(name) { cfg.mapping.x=name; } return cfg.mapping.x; }},\n      { disp: 'Y Axis', idx: 2, config: cfg.layout.yaxis, metric: (name) => { if(name) { cfg.mapping.y=name; } return cfg.mapping.y; }},\n      { disp: 'Z Axis', idx: 3, config: cfg.layout.yaxis, metric: (name) => { if(name) { cfg.mapping.z=name; } return cfg.mapping.z; }}\n    ];\n  }\n\n  isAxisVisible(axis) {\n    if(axis.idx==3) {\n      return this.panel.pconfig.settings.type === 'scatter3d';\n    }\n    return true;\n  }\n\n  onSegsChanged() {\n    this.panel.pconfig.settings.marker.symbol = this.segs.symbol.value;\n    this.onConfigChanged();\n  }\n\n  onPanelInitalized() {\n    this.onConfigChanged();\n  }\n\n  onRender() {\n    // ignore fetching data if another panel is in fullscreen\n    if (this.otherPanelInFullscreenMode()) { return; }\n\n\n    if(!this.initalized) {\n      var s = this.panel.pconfig.settings;\n\n      var options = {\n        showLink: false,\n        displaylogo: false,\n        displayModeBar: s.displayModeBar,\n        modeBarButtonsToRemove: ['sendDataToCloud'] //, 'select2d', 'lasso2d']\n      }\n\n      var data = [this.trace];\n      var rect = this.graph.getBoundingClientRect();\n\n      var old = this.layout;\n      this.layout = $.extend(true, {}, this.panel.pconfig.layout );\n      this.layout.height = this.height;\n      this.layout.width = rect.width;\n      if(old) {\n        this.layout.xaxis.title = old.xaxis.title;\n        this.layout.yaxis.title = old.yaxis.title;\n      }\n\n      Plotly.newPlot(this.graph, data, this.layout, options);\n\n      this.graph.on('plotly_click', (data) => {\n        throw new Error();\n      });\n\n      if(true) {\n        this.graph.on('plotly_hover', (data, xxx) => {\n          if(data.points.length>0) {\n            var idx = 0;\n            var pt = data.points[idx];\n            var dataText = '';\n            if(pt.data !== undefined && pt.data.ts !== undefined){\n              dataText = pt.data.ts[pt.pointNumber];\n            }\n            var body = '<div class=\"graph-tooltip-time\">'+ dataText +'</div>';\n            body += \"<center>\";\n            body += pt.x + ', '+pt.y;\n            body += \"</center>\";\n\n            this.$tooltip.html( body ).place_tt( this.mouse.pageX + 10, this.mouse.pageY);\n          }\n        }).on('plotly_unhover', (data) => {\n          this.$tooltip.detach();\n        });\n      }\n\n      this.graph.on('plotly_selected',  (data) => {\n\n        if(data.points.length == 0) {\n          return;\n        }\n        var min = Number.MAX_SAFE_INTEGER;\n        var max = Number.MIN_SAFE_INTEGER;\n\n        for(var i=0; i < data.points.length; i++){\n          var idx = data.points[i].pointNumber;\n          var ts = this.trace.ts[idx];\n          min = Math.min( min, ts);\n          max = Math.max( max, ts);\n        }\n\n        min -= 1000;\n        max += 1000;\n\n        var range = {from: moment.utc(min), to: moment.utc(max) };\n\n        this.timeSrv.setTime(range);\n\n        // rebuild the graph after query\n        if(this.graph) {\n          Plotly.Plots.purge(this.graph);\n          this.graph.innerHTML = '';\n          this.initalized = false;\n        }\n      });\n    }\n    else {\n      Plotly.redraw(this.graph);\n    }\n\n    if(this.sizeChanged && this.graph && this.layout) {\n      var rect = this.graph.getBoundingClientRect();\n      this.layout.width = rect.width;\n      Plotly.Plots.resize(this.graph);\n    }\n    this.sizeChanged = false;\n    this.initalized = true;\n  }\n\n  onDataReceived(dataList) {\n    this.trace.x = [];\n    this.trace.y = [];\n    this.trace.z = [];\n\n    this.data = {};\n    if(dataList.length < 2 && !this.panel.pconfig.detangle.coupling  ) {\n    }\n    else {\n      let dmapping = {\n        x:null,\n        y:null,\n        z:null\n      };\n\n      /**\n       * @detangleEdit start\n       * @author Ural\n       */\n      if (this.panel.pconfig.detangle.coupling) {\n        var t0 = performance.now();\n        dataList = this.detangleSrv.dataConvertor(dataList, this.templateSrv, this.panel.pconfig.detangle, 'table');\n        var t1 = performance.now();\n        console.log(\"Call to dataConvertor took \" + (t1 - t0) + \" milliseconds.\");\n      }\n      /**\n       * @detangleEdit end\n       * @author Ural\n       */\n\n        //   console.log( \"plotly data\", dataList);\n      let cfg = this.panel.pconfig;\n      let mapping = cfg.mapping;\n      let key = {\n        name: \"@time\",\n        type: 'ms',\n        missing: 0,\n        idx: -1,\n        points: []\n      };\n      let idx = {\n        name: \"@index\",\n        type: 'number',\n        missing: 0,\n        idx: -1,\n        points: []\n      };\n      this.data[key.name] = key;\n      this.data[idx.name] = idx;\n      for(let i=0; i<dataList.length; i++) {\n        let datapoints = dataList[i].datapoints;\n        if(datapoints !== undefined && datapoints.length > 0) {\n          let val = {\n            name: dataList[i].target,\n            type: 'number',\n            missing: 0,\n            idx: i,\n            points: []\n          };\n          if(_.isString(datapoints[0][0])) {\n            val.type = 'string';\n          }\n          else if(_.isBoolean(datapoints[0][0])) {\n            val.type = 'boolean';\n          }\n\n          // Set the default mapping values\n          if(i==0) {\n            dmapping.x = val.name;\n          }\n          else if(i==1) {\n            dmapping.y = val.name;\n          }\n          else if(i==2) {\n            dmapping.z = val.name;\n          }\n\n          this.data[val.name] = val;\n          if(key.points.length==0) {\n            for(var j=0; j<datapoints.length; j++) {\n              key.points.push( datapoints[j][1] );\n              val.points.push( datapoints[j][0] );\n              idx.points.push( j );\n            }\n          }\n          else {\n            for(var j=0; j<datapoints.length; j++) {\n              if(j >= key.points.length ) {\n                break;\n              }\n              // Make sure it is from the same timestamp\n              if(key.points[j] == datapoints[j][1]) {\n                val.points.push( datapoints[j][0] );\n              }\n              else {\n                val.missing = val.missing+1;\n              }\n            }\n          }\n        }\n        else{\n          let columns = dataList[i].columns;\n          let rows = dataList[i].rows;\n          if(rows.length > 0){\n            let val = {\n              name: columns[1].text,\n              type: 'number',\n              missing: 0,\n              idx: i,\n              points: []\n            };\n\n            if(i==0) {\n              dmapping.x = val.name;\n            }\n            else if(i==1) {\n              dmapping.y = val.name;\n            }\n            else if(i==2) {\n              dmapping.z = val.name;\n            }\n\n            this.data[val.name] = val;\n            if(key.points.length==0) {\n              for(var j=0; j<rows.length; j++) {\n                key.points.push( rows[j][0] );\n                val.points.push( rows[j][1] );\n                idx.points.push( j );\n              }\n            }\n            else {\n              for(var j=0; j<rows.length; j++) {\n                if(j >= key.points.length ) {\n                  break;\n                }\n                // Make sure it is from the same timestamp\n                if(key.points[j] == rows[j][0]) {\n                  val.points.push( rows[j][1] );\n                }\n                else {\n                  val.missing = val.missing+1;\n                }\n              }\n            }\n          }\n        }\n      }\n\n      // Maybe overwrite?\n      if(!mapping.x) mapping.x = dmapping.x;\n      if(!mapping.y) mapping.y = dmapping.y;\n      if(!mapping.z) mapping.z = dmapping.z;\n\n      // console.log( \"GOT\", this.data, mapping );\n\n      var dX = this.data[mapping.x];\n      var dY = this.data[mapping.y];\n      var dZ = null;\n      var dC = null;\n      var dS = null;\n      var dT = null;\n\n      if(!dX) {\n        throw { message: \"Unable to find X: \"+mapping.x };\n      }\n      if(!dY) {\n        throw { message: \"Unable to find Y: \"+mapping.y };\n      }\n\n\n      this.trace.ts = key.points;\n      this.trace.x = dX.points;\n      this.trace.y = dY.points;\n\n      if(cfg.settings.type == 'scatter3d') {\n        dZ = this.data[mapping.z];\n        if(!dZ) {\n          throw { message: \"Unable to find Z: \"+mapping.z };\n        }\n        this.layout.scene.xaxis.title = dX.name;\n        this.layout.scene.yaxis.title = dY.name;\n        this.layout.scene.zaxis.title = dZ.name;\n\n        this.trace.z = dZ.points;\n      }\n      else {\n        this.layout.xaxis.title = dX.name;\n        this.layout.yaxis.title = dY.name;\n      }\n\n\n      this.trace.marker = $.extend(true, {}, cfg.settings.marker);\n      this.trace.line = $.extend(true, {}, cfg.settings.line);\n\n      if(mapping.size) {\n        dS = this.data[mapping.size];\n        if(!dS) {\n          throw { message: \"Unable to find Size: \"+mapping.size };\n        }\n        this.trace.marker.size = dS.points;\n      }\n\n      // Set the marker colors\n      if( cfg.settings.color_option == 'ramp' ) {\n        if(!mapping.color) {\n          mapping.color = idx.name;\n        }\n        dC = this.data[mapping.color];\n        if(!dC) {\n          throw { message: \"Unable to find Color: \"+mapping.color };\n        }\n        this.trace.marker.color = dC.points;\n      }\n\n    }\n    this.render();\n  }\n\n  onConfigChanged() {\n    if(this.graph) {\n      Plotly.Plots.purge(this.graph);\n      this.graph.innerHTML = '';\n      this.initalized = false;\n    }\n\n    var cfg = this.panel.pconfig;\n    this.trace.type = cfg.settings.type;\n    this.trace.mode = cfg.settings.mode;\n\n    var axis = [ this.panel.pconfig.layout.xaxis, this.panel.pconfig.layout.yaxis];\n    for(let i=0; i<axis.length; i++) {\n      if( axis[i].rangemode === 'between' ) {\n        if( axis[i].range == null) {\n          axis[i].range = [0, null];\n        }\n      }\n      else {\n        axis[i].range = null;\n      }\n    }\n    this.refresh();\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    this.graph = elem.find('.plotly-spot')[0];\n    this.initalized = false;\n    elem.on( 'mousemove', (evt) => {\n      this.mouse = evt;\n    });\n  }\n\n  //---------------------------\n\n\n  getSymbolSegs()\n  {\n    var txt = [\n      \"circle\",\"circle-open\",\"circle-dot\",\"circle-open-dot\",\n      \"square\",\"square-open\",\"square-dot\",\"square-open-dot\",\n      \"diamond\",\"diamond-open\",\n      \"diamond-dot\",\"diamond-open-dot\",\n      \"cross\",\"cross-open\",\n      \"cross-dot\",\"cross-open-dot\",\n      \"x\",\"x-open\",\"x-dot\",\"x-open-dot\",\n      \"triangle-up\",\n      \"triangle-up-open\",\n      \"triangle-up-dot\",\n      \"triangle-up-open-dot\",\n      \"triangle-down\",\n      \"triangle-down-open\",\n      \"triangle-down-dot\",\n      \"triangle-down-open-dot\",\n      \"triangle-left\",\n      \"triangle-left-open\",\n      \"triangle-left-dot\",\n      \"triangle-left-open-dot\",\n      \"triangle-right\",\n      \"triangle-right-open\",\n      \"triangle-right-dot\",\n      \"triangle-right-open-dot\",\n      \"triangle-ne\",\n      \"triangle-ne-open\",\n      \"triangle-ne-dot\",\n      \"triangle-ne-open-dot\",\n      \"triangle-se\",\n      \"triangle-se-open\",\n      \"triangle-se-dot\",\n      \"triangle-se-open-dot\",\n      \"triangle-sw\",\n      \"triangle-sw-open\",\n      \"triangle-sw-dot\",\n      \"triangle-sw-open-dot\",\n      \"triangle-nw\",\n      \"triangle-nw-open\",\n      \"triangle-nw-dot\",\n      \"triangle-nw-open-dot\",\n      \"pentagon\",\n      \"pentagon-open\",\n      \"pentagon-dot\",\n      \"pentagon-open-dot\",\n      \"hexagon\",\n      \"hexagon-open\",\n      \"hexagon-dot\",\n      \"hexagon-open-dot\",\n      \"hexagon2\",\n      \"hexagon2-open\",\n      \"hexagon2-dot\",\n      \"hexagon2-open-dot\",\n      \"octagon\",\n      \"octagon-open\",\n      \"octagon-dot\",\n      \"octagon-open-dot\",\n      \"star\",\n      \"star-open\",\n      \"star-dot\",\n      \"star-open-dot\",\n      \"hexagram\",\n      \"hexagram-open\",\n      \"hexagram-dot\",\n      \"hexagram-open-dot\",\n      \"star-triangle-up\",\n      \"star-triangle-up-open\",\n      \"star-triangle-up-dot\",\n      \"star-triangle-up-open-dot\",\n      \"star-triangle-down\",\n      \"star-triangle-down-open\",\n      \"star-triangle-down-dot\",\n      \"star-triangle-down-open-dot\",\n      \"star-square\",\n      \"star-square-open\",\n      \"star-square-dot\",\n      \"star-square-open-dot\",\n      \"star-diamond\",\n      \"star-diamond-open\",\n      \"star-diamond-dot\",\n      \"star-diamond-open-dot\",\n      \"diamond-tall\",\n      \"diamond-tall-open\",\n      \"diamond-tall-dot\",\n      \"diamond-tall-open-dot\",\n      \"diamond-wide\",\n      \"diamond-wide-open\",\n      \"diamond-wide-dot\",\n      \"diamond-wide-open-dot\",\n      \"hourglass\",\n      \"hourglass-open\",\n      \"bowtie\",\n      \"bowtie-open\",\n      \"circle-cross\",\n      \"circle-cross-open\",\n      \"circle-x\",\n      \"circle-x-open\",\n      \"square-cross\",\n      \"square-cross-open\",\n      \"square-x\",\n      \"square-x-open\",\n      \"diamond-cross\",\n      \"diamond-cross-open\",\n      \"diamond-x\",\n      \"diamond-x-open\",\n      \"cross-thin\",\n      \"cross-thin-open\",\n      \"x-thin\",\n      \"x-thin-open\",\n      \"asterisk\",\n      \"asterisk-open\",\n      \"hash\",\n      \"hash-open\",\n      \"hash-dot\",\n      \"hash-open-dot\",\n      \"y-up\",\n      \"y-up-open\",\n      \"y-down\",\n      \"y-down-open\",\n      \"y-left\",\n      \"y-left-open\",\n      \"y-right\",\n      \"y-right-open\",\n      \"line-ew\",\n      \"line-ew-open\",\n      \"line-ns\",\n      \"line-ns-open\",\n      \"line-ne\",\n      \"line-ne-open\",\n      \"line-nw\",\n      \"line-nw-open\"\n    ];\n\n    var segs = [];\n    _.forEach(txt, (val) => {\n      segs.push( this.uiSegmentSrv.newSegment( val ) );\n    });\n    return this.q.when( segs );\n  }\n}\nPlotlyPanelCtrl.templateUrl = 'module.html';\n\nexport {\n  PlotlyPanelCtrl as PanelCtrl\n};\n\n\n"]}